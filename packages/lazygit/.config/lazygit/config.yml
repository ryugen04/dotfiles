git:
  parseEmoji: true
gui:
  language: en
  showIcons: true
os:
  editPreset: "nvim"
customCommands:
  # Commit (Ctrl+S)
  - key: "<c-s>"
    context: "global"
    description: "Conventional commit"
    prompts:
      - type: "menu"
        title: "What kind of commit type is it?"
        key: "Type"
        options:
          - name: "fix"
            description: "バグや不具合の修正"
            value: "fix"
          - name: "feat"
            description: "新機能の追加"
            value: "feat"
          - name: "docs"
            description: "ドキュメントの更新や改善"
            value: "docs"
          - name: "style"
            description: "コードフォーマットの修正、UIのみの変更"
            value: "style"
          - name: "refactor"
            description: "パフォーマンスの改善なしのコードの改善"
            value: "refactor"
          - name: "test"
            description: "テストの追加や改善"
            value: "test"
          - name: "perf"
            description: "パフォーマンスの改善"
            value: "perf"
          - name: "build"
            description: "ビルドシステムや外部依存関係の変更"
            value: "build"
          - name: "ci"
            description: "CI設定ファイルやスクリプトの変更"
            value: "ci"
          - name: "chore"
            description: "ビルドプロセスの変更や改善"
            value: "chore"
          - name: "wip"
            description: "作業中"
            value: "wip"
      - type: "input"
        title: "Enter the Message"
        key: "Message"
        initialValue: ""
      - type: "menu"
        title: "Choose the emoji"
        key: "Emoji"
        options:
          # 空
          - name: '(empty)'
            description: '絵文字なし'
            value: ''
          # feat
          - name: ':sparkles:'
            description: '(feat) ✨ 新機能の追加'
            value: ':sparkles:'
          - name: ':tada:'
            description: "(feat) \U0001F389 初回コミット/大きな機能"
            value: ':tada:'
          - name: ':children_crossing:'
            description: "(feat) \U0001F6B8 UX/ユーザビリティの改善"
            value: ':children_crossing:'
          # fix
          - name: ':bug:'
            description: "(fix) \U0001F41B バグ修正"
            value: ':bug:'
          - name: ':ambulance:'
            description: "(fix) \U0001F691 致命的なバグの緊急修正"
            value: ':ambulance:'
          - name: ':lock:'
            description: "(fix) \U0001F512 セキュリティ問題の修正"
            value: ':lock:'
          - name: ':adhesive_bandage:'
            description: "(fix) \U0001FA79 軽微な修正"
            value: ':adhesive_bandage:'
          # docs
          - name: ':memo:'
            description: "(docs) \U0001F4DD ドキュメントの追加・更新"
            value: ':memo:'
          - name: ':bulb:'
            description: "(docs) \U0001F4A1 ソースコードにコメント追加"
            value: ':bulb:'
          # style
          - name: ':art:'
            description: "(style) \U0001F3A8 コード構造/フォーマットの改善"
            value: ':art:'
          - name: ':lipstick:'
            description: "(style) \U0001F484 UI/スタイルファイルの更新"
            value: ':lipstick:'
          # refactor
          - name: ':recycle:'
            description: '(refactor) ♻️ コードのリファクタリング'
            value: ':recycle:'
          - name: ':fire:'
            description: "(refactor) \U0001F525 コードやファイルの削除"
            value: ':fire:'
          - name: ':coffin:'
            description: '(refactor) ⚰️ デッドコードの削除'
            value: ':coffin:'
          - name: ':truck:'
            description: "(refactor) \U0001F69A ファイルの移動/リネーム"
            value: ':truck:'
          # test
          - name: ':white_check_mark:'
            description: '(test) ✅ テストの追加・更新'
            value: ':white_check_mark:'
          - name: ':test_tube:'
            description: "(test) \U0001F9EA 失敗するテストの追加"
            value: ':test_tube:'
          # perf
          - name: ':zap:'
            description: '(perf) ⚡ パフォーマンスの改善'
            value: ':zap:'
          # build
          - name: ':package:'
            description: "(build) \U0001F4E6 パッケージ/依存関係の追加・更新"
            value: ':package:'
          - name: ':heavy_plus_sign:'
            description: '(build) ➕ 依存関係の追加'
            value: ':heavy_plus_sign:'
          - name: ':heavy_minus_sign:'
            description: '(build) ➖ 依存関係の削除'
            value: ':heavy_minus_sign:'
          - name: ':arrow_up:'
            description: '(build) ⬆️ 依存関係のアップグレード'
            value: ':arrow_up:'
          - name: ':arrow_down:'
            description: '(build) ⬇️ 依存関係のダウングレード'
            value: ':arrow_down:'
          # ci
          - name: ':construction_worker:'
            description: "(ci) \U0001F477 CI関連の追加・更新"
            value: ':construction_worker:'
          - name: ':green_heart:'
            description: "(ci) \U0001F49A CIビルドの修正"
            value: ':green_heart:'
          # chore
          - name: ':wrench:'
            description: "(chore) \U0001F527 設定ファイルの追加・更新"
            value: ':wrench:'
          - name: ':building_construction:'
            description: "(chore) \U0001F3D7️ アーキテクチャの変更"
            value: ':building_construction:'
          - name: ':see_no_evil:'
            description: "(chore) \U0001F648 .gitignoreの追加・更新"
            value: ':see_no_evil:'
          # wip
          - name: ':construction:'
            description: "(wip) \U0001F6A7 作業中"
            value: ':construction:'
      - type: "confirm"
        title: "Commit"
        body: "Commit with the message '{{.Form.Type}}: {{.Form.Message}}{{.Form.Emoji}}'. Is this okay?"
    command: "bash -c 'type=\"{{.Form.Type}}\"; message=\"{{.Form.Message}}\"; emoji=\"{{.Form.Emoji}}\"; commit_message=\"$type: $message $emoji\"; git commit -m \"$commit_message\"'"
    loadingText: "Commiting..."
  # Pull --rebase (Ctrl+R)
  - key: "<c-r>"
    context: "global"
    description: "Pull --rebase from remote"
    prompts:
      - type: "menu"
        title: "ベースブランチを選択"
        key: "Branch"
        options:
          - name: "develop"
            description: "developブランチからrebase pull"
            value: "develop"
          - name: "main"
            description: "mainブランチからrebase pull"
            value: "main"
          - name: "master"
            description: "masterブランチからrebase pull"
            value: "master"
    command: "git pull --rebase origin {{.Form.Branch}}"
    loadingText: "Pull中..."
  # Force push (Ctrl+F)
  - key: "<c-f>"
    context: "global"
    description: "Force push (--force-with-lease)"
    prompts:
      - type: "confirm"
        title: "Force Push"
        body: "本当に force push しますか？"
    command: "git push origin HEAD --force-with-lease"
    loadingText: "Push中..."
  # Delete merged branches (Ctrl+D)
  - key: "<c-d>"
    context: "global"
    description: "Delete merged branches"
    command: >-
      bash -c ' branches=$(git branch --merged | grep -v "\*\|main\|master\|develop") if [ -z "$branches" ]; then

        echo "削除対象のマージ済みブランチはありません"
      else

        selected=$(echo "$branches" | fzf --multi --header="削除するブランチを選択 (Tab: 複数選択, Enter: 確定)")
        if [ -n "$selected" ]; then
          echo "$selected" | xargs -r git branch -d
        fi
      fi '
    loadingText: "実行中..."
  # PR作成 (Ctrl+P) - octo.nvim
  - key: "<c-p>"
    context: "global"
    description: "Pull Request作成 (octo.nvim)"
    command: "git push -u origin HEAD && nvim -c 'Octo pr create'"
    subprocess: true
  # gh-dash起動 (Ctrl+G)
  - key: "<c-g>"
    context: "global"
    description: "gh-dash (GitHub Dashboard)"
    command: "gh dash"
    subprocess: true
  # ブランチのPRをOctoで開く (Ctrl+O) - localBranches
  - key: "<c-o>"
    context: "localBranches"
    description: "このブランチのPRをOctoで開く"
    command: >-
      bash -c ' git checkout {{.SelectedLocalBranch.Name}} && if gh pr view --json number -q .number >/dev/null 2>&1; then

        nvim -c "Octo pr"
      else

        echo "このブランチにPRがありません"; read -p "Enterで戻る"
      fi '
    subprocess: true
  # 現在のブランチのPRをOctoで開く (Ctrl+O) - global
  - key: "<c-o>"
    context: "global"
    description: "現在のブランチのPRをOctoで開く"
    command: >-
      bash -c ' if gh pr view --json number -q .number >/dev/null 2>&1; then

        nvim -c "Octo pr"
      else

        echo "このブランチにPRがありません"; read -p "Enterで戻る"
      fi '
    subprocess: true
