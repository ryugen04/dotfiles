# font_family Cica
# bold_font auto
# italic_font auto
# bold_italic_font auto

tab_bar_style powerline
font_size 12
linux_display_server x11
adjust_line_height 0
adjust_column_width 0

cursor #52ad70
cursor_text_color #FEFFFF
cursor_shape block
cursor_blink_interval 0

# Cursor Trail (Neovide風アニメーション)
cursor_trail 2
cursor_trail_decay 0.05 0.1
cursor_trail_start_threshold 10

# Nerd Fontsシンボルマッピング
# メインフォントがFiraCode Nerd Fontだが、一部範囲で明示的な指定が必要
# Material Design Icons (Nerd Font v3: U+F0001-U+F1AF0)
symbol_map U+f0001-U+f1af0 FiraCode Nerd Font

# 絵文字はApple Color Emojiにフォールバック
symbol_map U+1F600-U+1F64F,U+1F300-U+1F5FF,U+1F680-U+1F6FF,U+1F900-U+1F9FF,U+1FA00-U+1FAFF Apple Color Emoji

foreground #D1D2D3
background #16171E

#: black
color0 #000000
color8 #676767

#: red
color1 #E68E8E
color9 #FF6D67

#: green
color2  #83AC8E
color10 #5FF967

#: yellow
color3  #F5B78A
color11 #FEFB67

#: blue
color4  #9BB8DC
color12 #6871FF

#: magenta
color5  #BAACE2
color13 #FF76FF

#: cyan
color6  #00C5C7
color14 #5FFDFF

#: white
color7  #C7C7C7
color15 #FEFFFF

# タブバーのカスタムカラー (Weztermのnightfoxテーマ風)
active_tab_foreground   #dcffff
active_tab_background   #3b7070
active_tab_font_style   normal
inactive_tab_foreground #3a3939
inactive_tab_background #5c5c5c
inactive_tab_font_style normal
tab_bar_background      #575757

background_opacity 0.6
dynamic_background_opacity yes

scrollback_lines 10000

enabled_layouts splits:split_axis=horizontal,stack
# Remote Control設定（セキュリティ考慮）
# - password: パスワード認証のみ許可（外部プロセスからもアクセス可能）
# - パスワード: 環境変数 KITTY_RC_PASSWORD で認証
# - ソケット: /tmp配下でPID分離（macOS互換）
# - 許可コマンド: get-text, ls, launch, send-text, focus-window のみ
allow_remote_control password
listen_on unix:/tmp/kitty-socket-{kitty_pid}
remote_control_password "claude-dev" get-text ls launch send-text focus-window
copy_on_select yes
enable_audio_bell no

tab_bar_edge top
tab_bar_style powerline
tab_powerline_style angled
tab_title_template " {index}: {(tab.active_wd.split('/')[-1] + ' - ' + title): <501}"
window_padding_width 0

# デフォルトシェル（OS別に適切なシェルを使用）
# macOS: zsh（デフォルト）、Linux: bash + starship
# 注: macOSではshellを指定しないことでシステムのデフォルトシェル(zsh)が使用される
# Linux環境ではenv変数またはkitty.conf.localで上書きする想定

# shell integration
shell_integration enabled

# すべてのデフォルトキーマッピングをクリア
clear_all_shortcuts yes

# Leader keyの設定: Ctrl+a
kitty_mod ctrl+a

# Leader + a で実際のCtrl-aを送信
map ctrl+a>a send_text all \x01

# 新規タブ作成: Leader + t
map ctrl+a>t new_tab_with_cwd

map ctrl+a>w start_resizing_window

# ペインを閉じる: Leader + q
map ctrl+a>q close_window

# 縦分割: Leader + -
map ctrl+a>minus launch --location=hsplit --cwd=current

# 横分割: Leader + /
map ctrl+a>slash launch --location=vsplit --cwd=current

# ペイン選択: Leader + s (矢印キーで選択、Enterで確定)
map ctrl+a>s nth_window -1

# 前のタブ: Leader + .
map ctrl+a>period next_tab

# 次のタブ: Leader + ,
map ctrl+a>comma previous_tab

# タブ名変更: Leader + r
map ctrl+a>r set_tab_title

# コピーモード: Leader + v
map ctrl+a>v show_scrollback

# ペースト: Ctrl+Shift+v
map ctrl+shift+v paste_from_clipboard

# 透明度切り替え: Leader + o (opacity)
map ctrl+a>o kitten kittens/toggle_opacity.py

# lazygit: Leader + g (git)
# macOS: kittenでポップアップ表示
# map ctrl+a>g kitten kittens/popup.py lazygit
# Linux: 別タブで起動
map ctrl+a>g launch --type=tab --cwd=current lazygit

# ペイン移動: Ctrl + hjkl (vim-kitty-navigatorでneovimとシームレス連携)
# neovim内では内部ウィンドウを移動、端に到達したらkittyペインに移動
map ctrl+h kitten kittens/pass_keys.py left   ctrl+h
map ctrl+j kitten kittens/pass_keys.py bottom ctrl+j
map ctrl+k kitten kittens/pass_keys.py top    ctrl+k
map ctrl+l kitten kittens/pass_keys.py right  ctrl+l

# ペイン移動（リーダーキー版）: Leader + hjkl
map ctrl+a>h neighboring_window left
map ctrl+a>j neighboring_window down
map ctrl+a>k neighboring_window up
map ctrl+a>l neighboring_window right

# タブ番号で移動
map ctrl+a>1 goto_tab 1
map ctrl+a>2 goto_tab 2
map ctrl+a>3 goto_tab 3
map ctrl+a>4 goto_tab 4
map ctrl+a>5 goto_tab 5
map ctrl+a>6 goto_tab 6
map ctrl+a>7 goto_tab 7
map ctrl+a>8 goto_tab 8
map ctrl+a>9 goto_tab 9

# Shift + Enterで改行
map shift+enter send_text all \x0a

# 基本的なショートカット
map ctrl+shift+c copy_to_clipboard
map ctrl+shift+equal change_font_size all +1.0
map ctrl+shift+minus change_font_size all -1.0
map ctrl+shift+backspace change_font_size all 0


# Quick Access Terminal: Leader + p (popup)
map ctrl+a>p kitten kittens/toggle_quick_access_terminal.py

# macOS設定
macos_option_as_alt yes
macos_quit_when_last_window_closed yes
macos_traditional_fullscreen yes

# クリップボード設定
clipboard_control write-clipboard write-primary read-clipboard-ask read-primary-ask

# 右クリックでペースト
mouse_map right press ungrabbed paste_from_clipboard

confirm_os_window_close 0

# IME設定 (fcitx5)
text_composition_strategy legacy
env XMODIFIERS=@im=fcitx5
env GTK_IM_MODULE=fcitx5
env QT_IM_MODULE=fcitx5

# 1Password SSH Agent
env SSH_AUTH_SOCK=${HOME}/.1password/agent.sock


# BEGIN_KITTY_FONTS
font_family      family="FiraCode Nerd Font"
bold_font        auto
italic_font      auto
bold_italic_font auto
# END_KITTY_FONTS

# OS別設定の読み込み（存在しない場合は無視される）
# Linux: ~/.config/kitty/os/linux.conf をシンボリックリンクで作成
include os.conf
