---
description: "計画前の要件明確化: 不明点を質問し、粒度を判定してEnterPlanModeの精度を向上"
argument-hint: "[タスクの説明]"
allowed-tools: ["Read", "Grep", "Glob", "AskUserQuestion"]
---

# 計画前の要件明確化

**入力:** "$ARGUMENTS"

## 知識ベース

@skills/plan/SKILL.md
@skills/plan/templates/format.md

## 実行手順

### Step 1: コンテキスト収集

入力されたタスクに関連するコードベースを調査:
- 関連ファイルの特定
- 既存の実装パターンの確認
- 依存関係の把握

### Step 2: 理解の整理

タスクについて理解した内容を整理:
- 目的（Why）
- スコープ（What）
- 制約（Constraints）

### Step 3: 粒度判定

タスクの複雑さを分析し、計画の粒度を決定:
- **Quick**: 単純な変更、1-2ファイル
- **Standard**: 一般的な機能追加、複数ファイル
- **Detailed**: アーキテクチャ影響、設計判断を含む

判定根拠を明示すること。

### Step 4: 不明点の特定と質問

以下の観点で不明点を洗い出し、ユーザーに質問:
- スコープの境界
- 技術的選択肢
- 優先度・トレードオフ
- 前提条件の確認

**重要**: 前提を勝手に決めず、必ず確認する。

### Step 5: 出力

知識ベースの出力フォーマットに従い、以下を出力:

```markdown
# 要件明確化: {タスク名}

## 理解した内容
...

## 粒度判定
**レベル:** {Quick/Standard/Detailed}
**理由:** {判定根拠}

## 確認事項
1. {質問1}
2. {質問2}
...

## 次のステップ
確認後、EnterPlanMode で詳細な実装計画を作成します。
計画は {粒度レベル} フォーマットで出力されます。
```

## 質問がない場合

全ての情報が明確な場合も、以下を確認:
- 「この理解で正しいですか？」
- 「他に考慮すべき点はありますか？」

## EnterPlanModeへの引き継ぎ

本コマンド完了後、ユーザーが承認したら:

1. EnterPlanMode を起動
2. 明確化した内容を入力として渡す
3. 判定した粒度に応じたフォーマットで計画を作成

**注意**: EnterPlanMode は標準機能。本コマンドはその「前処理」として機能する。
